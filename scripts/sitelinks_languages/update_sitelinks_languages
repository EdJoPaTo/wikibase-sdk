#!/usr/bin/env bash

which jq > /dev/null || {
  echo "requires to have jq (https://stedolan.github.io/jq/) installed"
  exit 1
}

echo "Updating ./scripts/sitelinks_languages/sites.json"
curl -s 'https://www.wikidata.org/w/api.php?action=paraminfo&modules=wbgetentities&format=json' | jq '.paraminfo.modules[0].parameters[1].type' > ./scripts/sitelinks_languages/sites.json

echo "Generating ./src/helpers/sitelinks_languages.ts"
tee ./src/helpers/sitelinks_languages.ts << EOF
// Generated by 'npm run update-sitelinks-languages'
export const languages = $(ts-node ./scripts/sitelinks_languages/generate_sitelinks_languages.ts)
EOF

echo "Done updating ./src/helpers/sitelinks_languages.ts"
